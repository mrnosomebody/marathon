{% load static %}
<!DOCTYPE html>
<html lang=ru>
<head>
    <meta charset=utf-8>
    <title>Race</title>
    <link rel="stylesheet" href="{% static 'marathon/nicepage.css' %}" media="screen">
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="icon" type="image/png" href="{% static 'marathon/images/Screenshot_1.png' %}"/>
    <link rel="stylesheet" href="{% static 'race_creator/nicepage.css' %}" media="screen">
    <link rel="stylesheet" href="{% static 'race_creator/ConstructMarathon.css' %}" media="screen">
    <link rel="stylesheet" href="{% static 'marathon/first_page.css' %}" media="screen">
    <script class="u-script" type="text/javascript" src="{% static 'race_creator/jquery.js' %}" defer=""></script>
    <script class="u-script" type="text/javascript" src="{% static 'race_creator/nicepage.js' %}" defer=""></script>
    <script class="u-script" type="text/javascript" src="{% static 'marathon/jquery.js' %}" defer=""></script>
    <script class="u-script" type="text/javascript" src="{% static 'marathon/nicepage.js' %}" defer=""></script>
    <script type="text/javascript">

        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        const csrftoken = getCookie('csrftoken');
        function sendUltraPost(id) {
            $.ajax({ // create an AJAX call...
                data: {event: id},
                type: 'POST',
                headers: {'X-CSRFToken': csrftoken},
                url: '/join/',
                success: function (response) {
                    $('#join').replaceWith("Succeed");
                }
            });
        };

        function sendUltraPost1(id) {
            $.ajax({ // create an AJAX call...
                data: {event: id},
                type: 'POST',
                headers: {'X-CSRFToken': csrftoken},
                url: '/join-sponsor/',
                success: function (response) {
                    $('#join').replaceWith("Succeed");
                }
            });
        };
    </script>
</head>
<body class="u-expanded-width u-image u-image-default u-image-1" style="background-image: url({% static 'marathon/images/-min1.jpg' %});">

    <nav aria-label="breadcrumb" class="main-breadcrumb" style="color: whitesmoke">
        <ul>
            <a href="{% url 'first_page' %}" class="u-border-4 u-border-palette-4-base u-btn u-btn-round u-button-style u-custom-font u-font-courier-new u-none u-radius-25 u-text-body-alt-color u-text-hover-white u-btn-3"
                style="display: inline; margin-right: 20px;">Home</a>
            <a href="{% url 'm-event' %}" class="u-border-4 u-border-palette-4-base u-btn u-btn-round u-button-style u-custom-font u-font-courier-new u-none u-radius-25 u-text-body-alt-color u-text-hover-white u-btn-3"
                style="display: inline; margin-right: 20px;">Back to races</a>
            {% if user.is_authenticated and user.person.status is Runner or Coordinator or Organizer %}
                <a class="u-border-4 u-border-palette-4-base u-btn u-btn-round u-button-style u-custom-font u-font-courier-new u-none u-radius-25 u-text-body-alt-color u-text-hover-white u-btn-3"
                    style="display: inline; margin-right: 20px;margin-top: 15px" id='join' onclick="sendUltraPost({{ object.id }}); this.hide()">Join</a>
            {% elif user.is_authenticated %}
                <a class="u-border-4 u-border-palette-4-base u-btn u-btn-round u-button-style u-custom-font u-font-courier-new u-none u-radius-25 u-text-body-alt-color u-text-hover-white u-btn-3"
                    style="display: inline; margin-right: 20px;margin-top: 15px" id='join' onclick="sendUltraPost1({{ object.id }}); this.hide()">Sponsor this race</a>
            {% endif %}
        <h2 style="color: whitesmoke">{{ object.name }} Race</h2>
        </ul>
    </nav>

    <div class="center" style="color: whitesmoke">
        <ul>
            <li style="display: inline; margin-right: 60px;font-size: 27px">Place - {{ event.place }}</li>
            <li style="display: inline; margin-right: 60px;font-size: 27px">Date - {{ event.date }}</li>
            <li style="display: inline; margin-right: 60px;font-size: 27px">Distance
                - {{ event.distance.distance }} km
            </li>
        </ul>
    </div>

    <article class="media content-section">
        <div class="media-body">
            <div class="article-metadata">
                <div>
                    <h2 style="margin-left: 790px;margin-bottom: -80px;font-family: 'Trocchi';color: whitesmoke" >Participants list</h2>
                    <table>
                        <tr>
                            <th>Username</th>
                            <th>Status</th>
                            <th>Full name</th>
                            <th>Run time</th>
                            <th>Place</th>

                        </tr>
                        {% for run in object.run_set.all %}
                            <tr>
                                <th>{{ run.person.username }}</th>
                                <th>{{ run.person.status_id.get.name }}</th>
                                <th>{{ run.person.first_name }} {{ run.person.last_name }} {{ run.person.third_name }}</th>
                                <th>{{ run.time }}</th>
                                <th>{{ run.took_place }}</th>
                            </tr>
                        {% endfor %}
                    </table>

                </div>
            </div>
        </div>
    </article>
</body>
</html>

<style>
    body {
        font: normal medium/1.4 sans-serif;
    }

    table {
        overflow: hidden;
        border: 1px solid #d3d3d3;
        background: #fefefe;
        width: 70%;
        margin: 5% auto 0;
        -moz-border-radius: 5px; /* FF1+ */
        -webkit-border-radius: 5px; /* Saf3-4 */
        border-radius: 5px;
        -moz-box-shadow: 0 0 4px rgba(0, 0, 0, 0.2);
        -webkit-box-shadow: 0 0 4px rgba(0, 0, 0, 0.2);
    }

    th, td {
        padding: 18px 28px 18px;
        text-align: center;
    }

    th {
        padding-top: 22px;
        text-shadow: 1px 1px 1px #fff;
        background: #e8eaeb;
    }

    td {
        border-top: 1px solid #e0e0e0;
        border-right: 1px solid #e0e0e0;
    }

    tr.odd-row td {
        background: #f6f6f6;
    }

    td.first, th.first {
        text-align: left
    }

    td.last {
        border-right: none;
    }

    td {
        background: -moz-linear-gradient(100% 25% 90deg, #fefefe, #f9f9f9);
        background: -webkit-gradient(linear, 0% 0%, 0% 25%, from(#f9f9f9), to(#fefefe));
    }

    tr.odd-row td {
        background: -moz-linear-gradient(100% 25% 90deg, #f6f6f6, #f1f1f1);
        background: -webkit-gradient(linear, 0% 0%, 0% 25%, from(#f1f1f1), to(#f6f6f6));
    }

    th {
        background: -moz-linear-gradient(100% 20% 90deg, #e8eaeb, #ededed);
        background: -webkit-gradient(linear, 0% 0%, 0% 20%, from(#ededed), to(#e8eaeb));
    }

    tr:first-child th.first {
        -moz-border-radius-topleft: 5px;
        -webkit-border-top-left-radius: 5px; /* Saf3-4 */
    }

    tr:first-child th.last {
        -moz-border-radius-topright: 5px;
        -webkit-border-top-right-radius: 5px; /* Saf3-4 */
    }

    tr:last-child td.first {
        -moz-border-radius-bottomleft: 5px;
        -webkit-border-bottom-left-radius: 5px; /* Saf3-4 */
    }

    tr:last-child td.last {
        -moz-border-radius-bottomright: 5px;
        -webkit-border-bottom-right-radius: 5px; /* Saf3-4 */
    }
</style>